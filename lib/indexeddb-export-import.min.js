/**
 * Minified by jsDelivr using Terser v5.3.5.
 * Original file: /npm/indexeddb-export-import@2.1.2/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";function exportToJsonString(e,o){const t={},r=new Set(e.objectStoreNames);if(0===r.size)o(null,JSON.stringify(t));else{const n=Array.from(r),s=e.transaction(n,"readonly");s.onerror=e=>o(e,null),n.forEach((e=>{const r=[];s.objectStore(e).openCursor().onsuccess=s=>{const c=s.target.result;c?(r.push(c.value),c.continue()):(t[e]=r,n.length===Object.keys(t).length&&o(null,JSON.stringify(t)))}}))}}function importFromJsonString(e,o,t){const r=new Set(e.objectStoreNames);if(0===r.size)t(null);else{const n=Array.from(r),s=e.transaction(n,"readwrite");s.onerror=e=>t(e);const c=JSON.parse(o);n.forEach((e=>{let o=0;const r=Array.from(c[e]);c[e]&&r.length>0?r.forEach((r=>{const n=s.objectStore(e).add(r);n.onsuccess=()=>{o++,o===c[e].length&&(delete c[e],0===Object.keys(c).length&&t(null))},n.onerror=e=>{console.log(e)}})):(delete c[e],0===Object.keys(c).length&&t(null))}))}}function clearDatabase(e,o){const t=new Set(e.objectStoreNames),r=t.size;if(0===r)o(null);else{const n=Array.from(t),s=e.transaction(n,"readwrite");s.onerror=e=>o(e);let c=0;n.forEach((function(e){s.objectStore(e).clear().onsuccess=()=>{c++,c===r&&o(null)}}))}}"undefined"!=typeof module&&module.exports&&(module.exports={exportToJsonString:exportToJsonString,importFromJsonString:importFromJsonString,clearDatabase:clearDatabase});
